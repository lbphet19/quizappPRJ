(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{CSl6:function(e,t,i){"use strict";i.r(t),i.d(t,"AuthenicationModule",function(){return G});var s=i("ofXK"),n=i("mrSG");class r{constructor(e,t,i,s,n){this.id=e,this.username=t,this.name=i,this.roles=s,this.email=n}}var o=i("XNiG"),h=i("3N8a");class a extends h.a{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}var c=i("IjjT");class u extends c.a{}const l=new u(a);var d=i("quSY"),p=i("7o/Q"),g=i("WMd4");class b extends p.a{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(b.dispatch,this.delay,new m(e,this.destination)))}_next(e){this.scheduleMessage(g.a.createNext(e))}_error(e){this.scheduleMessage(g.a.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(g.a.createComplete()),this.unsubscribe()}}class m{constructor(e,t){this.notification=e,this.destination=t}}var _=i("9ppp"),f=i("Ylt2");class v extends o.a{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new I(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),s=this.scheduler,n=i.length;let r;if(this.closed)throw new _.a;if(this.isStopped||this.hasError?r=d.a.EMPTY:(this.observers.push(e),r=new f.a(this,e)),s&&e.add(e=new b(e,s)),t)for(let o=0;o<n&&!e.closed;o++)e.next(i[o]);else for(let o=0;o<n&&!e.closed;o++)e.next(i[o].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),r}_getNow(){return(this.scheduler||l).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,s=this._events,n=s.length;let r=0;for(;r<n&&!(e-s[r].time<i);)r++;return n>t&&(r=Math.max(r,n-t)),r>0&&s.splice(0,r),s}}class I{constructor(e,t){this.time=e,this.value=t}}class N extends o.a{constructor(){super(...arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}_subscribe(e){return this.hasError?(e.error(this.thrownError),d.a.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),d.a.EMPTY):super._subscribe(e)}next(e){this.hasCompleted||(this.value=e,this.hasNext=!0)}error(e){this.hasCompleted||super.error(e)}complete(){this.hasCompleted=!0,this.hasNext&&super.next(this.value),super.complete()}}var O=i("fXoL");class w{}let E=(()=>{class e extends class{constructor(){}loadScript(e,t,i,s=null){if("undefined"!=typeof document&&!document.getElementById(e)){let e=document.createElement("script");e.async=!0,e.src=t,e.onload=i,s||(s=document.head),s.appendChild(e)}}}{constructor(e,t={scope:"email"}){super(),this.clientId=e,this.initOptions=t}initialize(){return new Promise((t,i)=>{try{this.loadScript(e.PROVIDER_ID,"https://apis.google.com/js/platform.js",()=>{gapi.load("auth2",()=>{this.auth2=gapi.auth2.init(Object.assign(Object.assign({},this.initOptions),{client_id:this.clientId})),this.auth2.then(()=>{t()}).catch(e=>{i(e)})})})}catch(s){i(s)}})}getLoginStatus(t){const i=Object.assign(Object.assign({},this.initOptions),t);return new Promise((t,s)=>{if(this.auth2.isSignedIn.get()){let e=new w;const s=this.auth2.currentUser.get().getBasicProfile(),n=this.auth2.currentUser.get().getAuthResponse(!0);e.id=s.getId(),e.name=s.getName(),e.email=s.getEmail(),e.photoUrl=s.getImageUrl(),e.firstName=s.getGivenName(),e.lastName=s.getFamilyName(),e.response=n;const r=i=>{e.authToken=i.access_token,e.idToken=i.id_token,t(e)};i.refreshToken?this.auth2.currentUser.get().reloadAuthResponse().then(r):r(this.auth2.currentUser.get().getAuthResponse(!0))}else s("No user is currently logged in with "+e.PROVIDER_ID)})}signIn(e){const t=Object.assign(Object.assign({},this.initOptions),e);return new Promise((i,s)=>{(t&&t.offline_access?this.auth2.grantOfflineAccess(e):this.auth2.signIn(e)).then(e=>{let t=new w;if(e&&e.code)t.authorizationCode=e.code;else{let e=this.auth2.currentUser.get().getBasicProfile(),i=this.auth2.currentUser.get().getAuthResponse(!0),s=i.access_token,n=i.id_token;t.id=e.getId(),t.name=e.getName(),t.email=e.getEmail(),t.photoUrl=e.getImageUrl(),t.firstName=e.getGivenName(),t.lastName=e.getFamilyName(),t.authToken=s,t.idToken=n,t.response=i}i(t)},e=>{s(e)}).catch(e=>{s(e)})})}signOut(e){return new Promise((t,i)=>{let s;s=e?this.auth2.disconnect():this.auth2.signOut(),s.then(e=>{e?i(e):t()}).catch(e=>{i(e)})})}}return e.PROVIDER_ID="GOOGLE",e})(),S=(()=>{class e{constructor(e){this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new v(1),this.initialized=!1,this._initState=new N,e instanceof Promise?e.then(e=>{this.initialize(e)}):this.initialize(e)}get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}initialize(e){this.autoLogin=void 0!==e.autoLogin&&e.autoLogin;const{onError:t=console.error}=e;e.providers.forEach(e=>{this.providers.set(e.id,e.provider)}),Promise.all(Array.from(this.providers.values()).map(e=>e.initialize())).then(()=>{if(this.autoLogin){const e=[];let t=!1;this.providers.forEach((i,s)=>{let n=i.getLoginStatus();e.push(n),n.then(e=>{e.provider=s,this._user=e,this._authState.next(e),t=!0}).catch(console.debug)}),Promise.all(e).catch(()=>{t||(this._user=null,this._authState.next(null))})}}).catch(e=>{t(e)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}refreshAuthToken(t){return new Promise((i,s)=>{if(this.initialized)if(t!==E.PROVIDER_ID)s(e.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const n=this.providers.get(t);n?n.getLoginStatus({refreshToken:!0}).then(e=>{e.provider=t,this._user=e,this._authState.next(e),i()}).catch(e=>{s(e)}):s(e.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(e.ERR_NOT_INITIALIZED)})}signIn(t,i){return new Promise((s,n)=>{if(this.initialized){let r=this.providers.get(t);r?r.signIn(i).then(e=>{e.provider=t,s(e),this._user=e,this._authState.next(e)}).catch(e=>{n(e)}):n(e.ERR_LOGIN_PROVIDER_NOT_FOUND)}else n(e.ERR_NOT_INITIALIZED)})}signOut(t=!1){return new Promise((i,s)=>{if(this.initialized)if(this._user){let n=this.providers.get(this._user.provider);n?n.signOut(t).then(()=>{i(),this._user=null,this._authState.next(null)}).catch(e=>{s(e)}):s(e.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(e.ERR_NOT_LOGGED_IN);else s(e.ERR_NOT_INITIALIZED)})}}return e.\u0275fac=function(t){return new(t||e)(O.Ub("SocialAuthServiceConfig"))},e.\u0275prov=O.Eb({token:e,factory:e.\u0275fac}),e.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",e.ERR_NOT_LOGGED_IN="Not logged in",e.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",e.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",e})(),R=(()=>{class e{constructor(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}static initialize(t){return{ngModule:e,providers:[S,{provide:"SocialAuthServiceConfig",useValue:t}]}}}return e.\u0275mod=O.Gb({type:e}),e.\u0275inj=O.Fb({factory:function(t){return new(t||e)(O.Ub(e,12))},providers:[S],imports:[[s.c]]}),e})();var T=i("SrTG"),x=i("rw8+"),y=i("tyNb");function P(e,t){if(1&e){const e=O.Ob();O.Nb(0,"div",2),O.Nb(1,"h6",3),O.uc(2," Social Login Demo "),O.Mb(),O.Nb(3,"div",4),O.Nb(4,"h4",5),O.uc(5,"Not signed in"),O.Mb(),O.Nb(6,"p",6),O.uc(7,"Sign in with"),O.Mb(),O.Mb(),O.Nb(8,"div",4),O.Nb(9,"button",7),O.Xb("click",function(){return O.mc(e),O.Zb().signInWithGoogle()}),O.uc(10,"Click me!"),O.Mb(),O.Mb(),O.Mb()}}function k(e,t){if(1&e){const e=O.Ob();O.Nb(0,"div",2),O.Nb(1,"h6",3),O.uc(2," Social Login Demo "),O.Mb(),O.Jb(3,"div",4),O.Jb(4,"img",8),O.Nb(5,"div",4),O.Nb(6,"h4",5),O.uc(7),O.Mb(),O.Nb(8,"p",6),O.uc(9),O.Mb(),O.Mb(),O.Nb(10,"div",4),O.Nb(11,"button",9),O.Xb("click",function(){return O.mc(e),O.Zb().signOut()}),O.uc(12,"Sign out"),O.Mb(),O.Mb(),O.Mb()}if(2&e){const e=O.Zb();O.wb(4),O.fc("src",e.user.photoUrl,O.nc),O.wb(3),O.vc(e.user.name),O.wb(2),O.vc(e.user.email)}}let D=(()=>{class e{constructor(e,t,i,s){this.socialAuthService=e,this.authService=t,this.tokenService=i,this.route=s,this.loggedIn=!1}ngOnInit(){this.socialAuthService.authState.subscribe(e=>{this.user=e})}signInWithGoogle(){return Object(n.a)(this,void 0,void 0,function*(){let e=yield this.socialAuthService.signIn(E.PROVIDER_ID);console.log(e),this.authService.signinWithGoogle(e.idToken).subscribe(e=>{console.log(e),this.tokenService.saveToken(e.accessToken),this.tokenService.saveUser(new r(e.id,e.username,e.name,e.roles,e.email))}),this.route.navigate(["quiz/all"])})}signOut(){this.socialAuthService.signOut()}}return e.\u0275fac=function(t){return new(t||e)(O.Ib(S),O.Ib(T.a),O.Ib(x.a),O.Ib(y.b))},e.\u0275cmp=O.Cb({type:e,selectors:[["app-login"]],decls:3,vars:2,consts:[[1,"jumbotron","bg-transparent","text-center"],["class","card text-center",4,"ngIf"],[1,"card","text-center"],[1,"card-header"],[1,"card-block"],[1,"card-title"],[1,"card-text"],[3,"click"],[1,"card-img-top","img-responsive","photo",3,"src"],[1,"btn","btn-danger",3,"click"]],template:function(e,t){1&e&&(O.Nb(0,"div",0),O.sc(1,P,11,0,"div",1),O.sc(2,k,13,3,"div",1),O.Mb()),2&e&&(O.wb(1),O.ec("ngIf",!t.user),O.wb(1),O.ec("ngIf",t.user))},directives:[s.k],styles:[""]}),e})();const M=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=O.Cb({type:e,selectors:[["app-authenication"]],decls:2,vars:0,template:function(e,t){1&e&&(O.Nb(0,"p"),O.uc(1,"authenication works!"),O.Mb())},styles:[""]}),e})()},{path:"login",component:D}];let L=(()=>{class e{}return e.\u0275mod=O.Gb({type:e}),e.\u0275inj=O.Fb({factory:function(t){return new(t||e)},imports:[[y.c.forChild(M)],y.c]}),e})(),G=(()=>{class e{}return e.\u0275mod=O.Gb({type:e}),e.\u0275inj=O.Fb({factory:function(t){return new(t||e)},providers:[{provide:"SocialAuthServiceConfig",useValue:{autoLogin:!1,providers:[{id:E.PROVIDER_ID,provider:new E("468393702933-f7jsd3trnsgt4nkdqu4ir6dpihgdp8sh.apps.googleusercontent.com")}]}}],imports:[[s.c,L,R]]}),e})()}}]);