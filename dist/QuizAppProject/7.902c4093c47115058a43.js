(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"7UCR":function(e,t,n){"use strict";n.r(t),n.d(t,"UserModule",function(){return S});var s=n("ofXK"),o=n("3Pt+"),i=n("5+tZ"),r=n("Kqap"),u=n("BFxc"),c=n("xbPD"),a=n("mCNh");function d(e,t,n){return 0===n?[t]:(e.push(t),e)}var b=n("LRne"),l=n("cp0P"),p=n("fXoL"),w=n("PuOf"),h=n("tyNb"),m=n("tk/3");let f=(()=>{class e{constructor(e){this.http=e,this.API_URL="http://localhost:8080/api/v2/answer"}get(){return this.http.get(this.API_URL)}getById(e){return this.http.get(`${this.API_URL}/${e}`)}save(e){return this.http.post(""+this.API_URL,e)}saveMultipleAnswers(e){return this.http.post(this.API_URL+"/multiple",e)}update(e){return this.http.put(this.API_URL+"/update",e)}updateMultipleAnswers(e){return this.http.put(this.API_URL+"/update/multiple",e)}updateMultiple(e){return this.http.put(this.API_URL+"/update/multiple",e)}delete(e){return this.http.delete(`${this.API_URL}/delete/${e}`)}deleteMultiple(e){return this.http.post(this.API_URL+"/delete/multiple",e)}convertAnswerFormToAnswerRequest(e,t){const n=[];for(let s of t)n.push({question:{questionId:e},answerContent:s.answerContent,answerIsCorrect:s.answerIsCorrect});return n}convertAnswerUpdateForm(e,t){const n=[];for(let s of e)n.push(Object.assign(Object.assign({},s),{question:{questionId:t}}));return n}}return e.\u0275fac=function(t){return new(t||e)(p.Ub(m.b))},e.\u0275prov=p.Eb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var v=n("1kSV");function A(e,t){if(1&e&&(p.Nb(0,"div"),p.Jb(1,"input",9),p.uc(2," \xa0 "),p.Nb(3,"label",10),p.uc(4),p.Mb(),p.Jb(5,"br"),p.Mb()),2&e){const e=t.$implicit,n=p.Zb(2).$implicit;p.wb(1),p.fc("id",e.answerId),p.fc("name",n.questionId),p.fc("value",e.answerId),p.wb(2),p.fc("for",e.answerId),p.wb(1),p.vc(e.answerContent)}}function I(e,t){if(1&e&&(p.Nb(0,"div"),p.sc(1,A,6,5,"div",0),p.Mb()),2&e){const e=p.Zb().$implicit;p.wb(1),p.ec("ngForOf",e.answers)}}function g(e,t){if(1&e&&(p.Nb(0,"div"),p.Jb(1,"input",11),p.Nb(2,"label",10),p.uc(3),p.Mb(),p.Jb(4,"br"),p.Mb()),2&e){const e=t.$implicit;p.wb(1),p.fc("id",e.answerId),p.fc("value",e.answerId),p.wb(1),p.fc("for",e.answerId),p.wb(1),p.wc(" ",e.answerContent,"")}}function q(e,t){if(1&e&&(p.Nb(0,"div"),p.sc(1,g,5,4,"div",0),p.Mb()),2&e){const e=p.Zb().$implicit;p.wb(1),p.ec("ngForOf",e.answers)}}function F(e,t){if(1&e){const e=p.Ob();p.Nb(0,"div"),p.uc(1),p.Nb(2,"button",6),p.Xb("click",function(){p.mc(e);const n=t.index,s=p.Zb(),o=p.lc(8);return s.openUpdateModal(o,n)}),p.uc(3,"Update"),p.Mb(),p.Nb(4,"button",7),p.Xb("click",function(){p.mc(e);const n=t.$implicit;return p.Zb().deleteQuestion(n.questionId)}),p.uc(5,"Delete"),p.Mb(),p.Jb(6,"br"),p.sc(7,I,2,1,"div",8),p.sc(8,q,2,1,"div",8),p.Mb()}if(2&e){const e=t.$implicit,n=t.index;p.wb(1),p.xc(" Question ",n+1,". ",e.questionContent," "),p.wb(6),p.ec("ngIf","single-choice"===e.questionType),p.wb(1),p.ec("ngIf","multiple-choice"===e.questionType)}}function N(e,t){if(1&e){const e=p.Ob();p.Nb(0,"div"),p.Nb(1,"div",18),p.uc(2),p.Jb(3,"input",19),p.Nb(4,"input",20),p.Xb("click",function(){p.mc(e);const n=t.index,s=p.Zb().index;return p.Zb().setAnswerStatus(n,s)}),p.Mb(),p.Mb(),p.Mb()}if(2&e){const e=t.index;p.wb(1),p.ec("formGroupName",e),p.wb(1),p.wc(" Answer ",e+1,".")}}function Q(e,t){if(1&e){const e=p.Ob();p.Nb(0,"div"),p.Nb(1,"div",12),p.uc(2),p.Jb(3,"input",13),p.uc(4," Type: "),p.Nb(5,"select",14),p.Nb(6,"option",15),p.uc(7,"Nhieu dap an dung"),p.Mb(),p.Nb(8,"option",16),p.uc(9,"Lua chon 1 dap an"),p.Mb(),p.Mb(),p.Jb(10,"br"),p.Nb(11,"div",17),p.sc(12,N,5,2,"div",0),p.Mb(),p.Nb(13,"button",3),p.Xb("click",function(){p.mc(e);const n=t.index;return p.Zb().addAnswer(n)}),p.uc(14,"Add answer"),p.Mb(),p.Mb(),p.Mb()}if(2&e){const e=t.index,n=p.Zb();p.wb(1),p.ec("formGroupName",e),p.wb(1),p.wc(" ",e+1,". "),p.wb(10),p.ec("ngForOf",n.getAnswerAtIndex(e).controls)}}function M(e,t){if(1&e){const e=p.Ob();p.Nb(0,"div"),p.Nb(1,"div",18),p.uc(2),p.Jb(3,"input",19),p.Nb(4,"input",20),p.Xb("click",function(){p.mc(e);const n=t.index;return p.Zb(2).setAnswerStatus(n)}),p.Mb(),p.Nb(5,"button",3),p.Xb("click",function(){p.mc(e);const n=t.index;return p.Zb(2).removeAnswer(n)}),p.uc(6,"X"),p.Mb(),p.Mb(),p.Mb()}if(2&e){const e=t.index;p.wb(1),p.ec("formGroupName",e),p.wb(1),p.wc(" Answer ",e,".")}}function U(e,t){if(1&e){const e=p.Ob();p.Nb(0,"form",1),p.Nb(1,"div",21),p.Nb(2,"h4",22),p.uc(3,"Question update"),p.Mb(),p.Nb(4,"button",23),p.Xb("click",function(){return p.mc(e),p.Zb().closeModal()}),p.Nb(5,"span",24),p.uc(6,"\xd7"),p.Mb(),p.Mb(),p.Mb(),p.Nb(7,"div",25),p.uc(8," C\xe2u h\u1ecfi: "),p.Jb(9,"input",26),p.uc(10," Type: "),p.Nb(11,"select",27),p.Nb(12,"option",15),p.uc(13,"Nhieu dap an dung"),p.Mb(),p.Nb(14,"option",16),p.uc(15,"Lua chon 1 dap an"),p.Mb(),p.Mb(),p.Jb(16,"br"),p.Nb(17,"div",17),p.sc(18,M,7,2,"div",0),p.Mb(),p.Nb(19,"button",3),p.Xb("click",function(){return p.mc(e),p.Zb().addAnswer()}),p.uc(20,"Add answer"),p.Mb(),p.Mb(),p.Nb(21,"div",28),p.Nb(22,"button",29),p.Xb("click",function(){return p.mc(e),p.Zb().saveUpdateQuestion()}),p.uc(23,"Save"),p.Mb(),p.Mb(),p.Mb()}if(2&e){const e=p.Zb();p.ec("formGroup",e.questionUpdateForm),p.wb(18),p.ec("ngForOf",e.getAnswersFromQuestionUpdateForm().controls)}}let y=(()=>{class e{constructor(e,t,n,s,o){this.questionService=e,this.route=t,this.fb=n,this.answerService=s,this.modalService=o,this.updateAnswerIndex=0,this.deleteAnswerIds=[]}ngOnInit(){this.quizId=this.route.snapshot.params.id,this.getQuestionFromQuizId(this.quizId),this.createQuestionUpdateForm(),this.createQuizForm(),this.initQuizForm()}getQuestionFromQuizId(e){this.questionService.getByQuizId(e).subscribe(e=>this.questions=e)}createQuizForm(){this.quizForm=this.fb.group({questionForm:new o.c([])})}createQuestionUpdateForm(){this.questionUpdateForm=this.fb.group({questionId:new o.f,questionContent:new o.f,questionType:new o.f,answers:new o.c([])})}getAnswersFromQuestionUpdateForm(){return this.questionUpdateForm.get("answers")}questionForm(){return this.quizForm.get("questionForm")}newQuestion(e,t,n){return new o.h({questionId:new o.f(e||""),questionContent:new o.f(t||""),questionType:new o.f(n||""),answers:new o.c([])})}newAnswer(e,t,n,s){return new o.h({questionId:new o.f(e||null),answerId:new o.f(t||null),answerContent:new o.f(n||""),answerIsCorrect:new o.f(s||!1)})}addQuestion(){const e=this.newQuestion();this.questionForm().push(e)}addAnswer(e){const t=this.newAnswer();void 0!==e?this.getAnswerAtIndex(e).push(t):this.getAnswersFromQuestionUpdateForm().push(t)}getQuestionAtIndex(e){return this.questionForm().at(e)}getAnswerAtIndex(e){return this.getQuestionAtIndex(e).get("answers")}removeQuestion(e){this.questionForm().removeAt(e)}test(){console.log(this.answerService.convertAnswerFormToAnswerRequest(1,this.getAnswerAtIndex(0).value))}updateQuestion(e){let t=this.questions[e];this.questionUpdateForm.patchValue({questionId:t.questionId,questionType:t.questionType,questionContent:t.questionContent}),this.getAnswersFromQuestionUpdateForm().clear();for(let n of t.answers)this.getAnswersFromQuestionUpdateForm().push(new o.h({answerId:new o.f(n.answerId),answerContent:new o.f(n.answerContent),answerIsCorrect:new o.f(n.answerIsCorrect)}));this.updateAnswerIndex=t.answers.length-1}deleteQuestion(e){console.log(this.questions[e])}removeAnswer(e){e<=this.updateAnswerIndex&&(this.deleteAnswerIds.push(this.getAnswersFromQuestionUpdateForm().at(e).get("answerId").value),this.updateAnswerIndex--),this.getAnswersFromQuestionUpdateForm().removeAt(e)}viewForm(){let e=this.questionService.convertQuestionFormToQuestionRequest(this.quizId,this.questionForm().value);console.log(this.questionForm().value),Object(b.a)(...e).pipe(Object(i.a)((e,t)=>{const n=this.questionService.save(e);return Object(l.a)(n,Object(b.a)(t))}),Object(i.a)(e=>{let t=this.answerService.convertAnswerFormToAnswerRequest(e[0].questionId,this.getAnswerAtIndex(e[1]).value);return this.answerService.saveMultipleAnswers(t)}),function(e,t){return arguments.length>=2?function(n){return Object(a.a)(Object(r.a)(e,t),Object(u.a)(1),Object(c.a)(t))(n)}:function(t){return Object(a.a)(Object(r.a)((t,n,s)=>e(t,n,s+1)),Object(u.a)(1))(t)}}(d,[])).subscribe(e=>alert("thanh cong"))}setAnswerStatus(e,t){if(t){if("single-choice"===this.getQuestionAtIndex(t).get("questionType").value){let n=this.getAnswerAtIndex(t);for(let t=0;t<n.length;t++)t!==e&&n.at(t).get("answerIsCorrect").setValue(!1);n.at(e).get("answerIsCorrect").setValue(!0)}}else if("single-choice"===this.questionUpdateForm.get("questionType").value){let t=this.getAnswersFromQuestionUpdateForm();for(let n=0;n<t.length;n++)n!==e&&t.at(n).get("answerIsCorrect").setValue(!1);t.at(e).get("answerIsCorrect").setValue(!0)}}submitForm(){}initQuizForm(){}openUpdateModal(e,t){this.updateQuestion(t),this.modalService.open(e,{scrollable:!1,size:"lg"}).result.then(e=>{},e=>{})}closeModal(){this.deleteAnswerIds=[],this.modalService.dismissAll("Cross click"),this.updateAnswerIndex=-1}saveUpdateQuestion(){const e=this.getAnswersFromQuestionUpdateForm().value;console.log("deletes: "+this.deleteAnswerIds);let t=this.deleteAnswerIds;console.log(t);let n=[],s=[];for(let i=0;i<=this.updateAnswerIndex;i++)n.push(this.getAnswersFromQuestionUpdateForm().at(i).value);for(let i=this.updateAnswerIndex+1;i<e.length;i++)s.push(this.getAnswersFromQuestionUpdateForm().at(i).value);n=this.answerService.convertAnswerUpdateForm(n,this.questionUpdateForm.controls.questionId.value),s=this.answerService.convertAnswerUpdateForm(s,this.questionUpdateForm.controls.questionId.value),console.log("updates: "+JSON.stringify(n)),console.log("news: "+JSON.stringify(s));let o=this.questionService.convertQuestionUpdate(this.questionUpdateForm.value);console.log("update ques:"+JSON.stringify(o)),Object(l.a)(this.answerService.updateMultipleAnswers(n),this.answerService.saveMultipleAnswers(s),this.answerService.deleteMultiple(t),this.questionService.update(o)).subscribe(e=>console.log("success"),e=>console.log("Error")),this.deleteAnswerIds=[],this.updateAnswerIndex=-1,this.modalService.dismissAll("Saved")}}return e.\u0275fac=function(t){return new(t||e)(p.Ib(w.a),p.Ib(h.a),p.Ib(o.e),p.Ib(f),p.Ib(v.c))},e.\u0275cmp=p.Cb({type:e,selectors:[["app-user-quiz"]],decls:10,vars:3,consts:[[4,"ngFor","ngForOf"],[3,"formGroup"],["formArrayName","questionForm"],[3,"click"],["type","submit","value","Submit",3,"click"],["updateForm",""],[1,"btn","btn-primary","mr-1",3,"click"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"],["type","radio",3,"id","name","value"],[3,"for"],["type","checkbox","name","answerId",3,"id","value"],[2,"border","1px solid blue","padding","10px","width","600px","margin","5px",3,"formGroupName"],["type","text","formControlName","questionContent"],["formControlName","questionType"],["value","multiple-choice"],["value","single-choice"],["formArrayName","answers"],[3,"formGroupName"],["type","text","formControlName","answerContent",2,"margin-left","5em"],["type","checkbox","formControlName","answerIsCorrect",3,"click"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["type","text","formControlName","questionContent",1,"form-control"],["formControlName","questionType",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"]],template:function(e,t){1&e&&(p.sc(0,F,9,4,"div",0),p.Nb(1,"form",1),p.Nb(2,"div",2),p.sc(3,Q,15,3,"div",0),p.Nb(4,"button",3),p.Xb("click",function(){return t.addQuestion()}),p.uc(5,"Add question"),p.Mb(),p.Mb(),p.Nb(6,"input",4),p.Xb("click",function(){return t.viewForm()}),p.Mb(),p.Mb(),p.sc(7,U,24,2,"ng-template",null,5,p.tc),p.Jb(9,"br")),2&e&&(p.ec("ngForOf",t.questions),p.wb(1),p.ec("formGroup",t.quizForm),p.wb(2),p.ec("ngForOf",t.questionForm().controls))},directives:[s.j,o.v,o.o,o.i,o.d,s.k,o.j,o.b,o.n,o.g,o.s,o.p,o.u,o.a],styles:[""]}),e})(),x=(()=>{class e{constructor(e,t,n,s){this.questionService=e,this.route=t,this.fb=n,this.answerService=s}ngOnInit(){this.quizId=this.route.snapshot.params.id,this.getQuestionFromQuizId(this.quizId),this.createQuestionUpdateForm(),this.createQuizForm()}getQuestionFromQuizId(e){this.questions=this.questionService.getByQuizId(e)}createQuizForm(){this.quizForm=this.fb.group({questionForm:new o.c([])})}createQuestionUpdateForm(){this.questionUpdateForm=this.fb.group({questionId:new o.f,questionContent:new o.f,questionType:new o.f,answers:new o.c([])})}getAnswersFromQuestionUpdateForm(){return this.questionUpdateForm.get("answers")}questionForm(){return this.quizForm.get("questionForm")}newQuestion(e,t,n){return new o.h({questionId:new o.f(e||""),questionContent:new o.f(t||""),questionType:new o.f(n||""),answers:new o.c([])})}newAnswer(e,t,n,s){return new o.h({questionId:new o.f(e||""),answerId:new o.f(t||""),answerContent:new o.f(n||""),answerIsCorrect:new o.f(s||!1)})}addQuestion(){const e=this.newQuestion();this.questionForm().push(e)}addAnswer(e){const t=this.newAnswer();e?this.getAnswerAtIndex(e).push(t):this.getAnswersFromQuestionUpdateForm().push(t)}getQuestionAtIndex(e){return this.questionForm().at(e)}getAnswerAtIndex(e){return this.getQuestionAtIndex(e).get("answers")}removeQuestion(e){this.questionForm().removeAt(e)}removeAnswer(e,t){this.getAnswerAtIndex(e).removeAt(t)}test(){console.log(this.answerService.convertAnswerFormToAnswerRequest(1,this.getAnswerAtIndex(0).value))}}return e.\u0275fac=function(t){return new(t||e)(p.Ib(w.a),p.Ib(h.a),p.Ib(o.e),p.Ib(f))},e.\u0275cmp=p.Cb({type:e,selectors:[["app-quiz-admin"]],decls:0,vars:0,template:function(e,t){},styles:[""]}),e})();const C=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Cb({type:e,selectors:[["app-user"]],decls:2,vars:0,template:function(e,t){1&e&&(p.Nb(0,"p"),p.uc(1,"user works!"),p.Mb())},styles:[""]}),e})()},{path:"quiz",component:y},{path:"quiz/:id",component:y},{path:"admin/:id",component:x}];let O=(()=>{class e{}return e.\u0275mod=p.Gb({type:e}),e.\u0275inj=p.Fb({factory:function(t){return new(t||e)},imports:[[h.c.forChild(C)],h.c]}),e})(),S=(()=>{class e{}return e.\u0275mod=p.Gb({type:e}),e.\u0275inj=p.Fb({factory:function(t){return new(t||e)},imports:[[s.c,O,o.k,o.r]]}),e})()}}]);